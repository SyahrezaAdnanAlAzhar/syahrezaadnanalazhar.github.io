---
import { getCollection } from 'astro:content';
import Layout from '../../layouts/Layout.astro';
import Navbar from '../../components/layout/Navbar.astro';

// Get base URL for proper routing
const base = import.meta.env.BASE_URL;
const baseUrl = base.endsWith('/') ? base : `${base}/`;

// Generate static paths for all awards
export async function getStaticPaths() {
  const awards = await getCollection('awards');
  return awards.map((award) => ({
    params: { slug: award.slug },
    props: { award },
  }));
}

const { award } = Astro.props;
const { Content } = await award.render();

// Navy blue color palette for awards
const colors = {
  accent: '#2563eb',
  accentLight: '#dbeafe',
  accentBorder: '#60a5fa',
};
---

<Layout 
  title={`${award.data.title} | Syahreza Adnan`}
  description={award.data.description || `${award.data.title} - ${award.data.organizer}`}
>
  <!-- Redirect to home page with modal when loaded directly in browser -->
  <script is:inline define:vars={{ slug: award.slug, baseUrl }}>
    window.location.replace(baseUrl + '#award/' + slug);
  </script>

  <Navbar />
  
  <main class="award-detail-main">
    <div class="award-detail-container">
      <!-- Award Content (from MDX) -->
      <article class="award-content">
        <Content />
      </article>
    </div>
  </main>
</Layout>

<style>
  .award-detail-main {
    min-height: 100vh;
    padding-top: 6rem;
    padding-bottom: 4rem;
  }

  .award-detail-container {
    max-width: 56rem;
    margin: 0 auto;
    padding: 0 1.5rem;
  }

  /* Award Content (MDX) */
  .award-content {
    color: #1f2937;
    line-height: 1.8;
    font-weight: 500;
  }

  /* Custom lists */
  .award-content :global(.custom-list) {
    list-style-type: disc;
    margin: 1rem 0 1.25rem 0;
    padding-left: 1.75rem;
    color: #1f2937;
    font-weight: 500;
    font-size: 1rem;
    line-height: 1.75;
  }

  .award-content :global(.custom-list li) {
    margin-bottom: 0.75rem;
  }

  .award-content :global(.custom-list li:last-child) {
    margin-bottom: 0;
  }

  /* Section header navy blue accent for awards */
  .award-content :global(.section-header:hover) {
    border-color: #2563eb !important;
  }

  .award-content :global(.section-wrapper[data-collapsed="true"] .section-title) {
    color: #2563eb !important;
  }

  .award-content :global(.section-wrapper[data-collapsed="true"] .chevron-icon) {
    color: #2563eb !important;
  }

  /* Responsive */
  @media (min-width: 640px) {
    .award-detail-container {
      padding: 0 2rem;
    }
  }

  @media (min-width: 1024px) {
    .award-detail-container {
      padding: 0 3rem;
    }

    .award-detail-main {
      padding-top: 8rem;
    }
  }

  @media (max-width: 639px) {
    .award-detail-main {
      padding-top: 5rem;
    }

    .award-detail-container {
      padding: 0 1rem;
    }
  }
</style>
